module os
get posix

def getcwd() str
	cwd_utf8 := posix.getcwd(null)
	if cwd_utf8 != null
		cwd := str(mbstowcs(cwd_utf8))
		posix.free(cwd_utf8)
		return cwd
	else
		posix.puts("could not allocate enough memory to store the working directory!")
		posix.exit(-1)
		return null as str


def getenv(name str) str?
	let s = wcstombs(name.raw)
	let value = posix.getenv(s)
	posix.free(s)

	if value != null
		return str(mbstowcs(value))
	else
		return null
