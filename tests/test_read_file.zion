module _
link module file
link module os
link module sys

# test: pass
# expect: This text should appear

def main()
	if f := file.open("tests/test_read_file.zion", file.ReadOnly)
		while true
			buffer := file.read(f, 4 * 1024)
			when buffer
				is std/bytes
					posix.write(1r, buffer.data, buffer.cb)
				is file/EOF
					break
				is file/ReadError
					print("Read Error")
					sys.exit(-1)
